---
title: "**Phylodynamics of Infectious Disease Epidemics (Volz et al., 2009)**"
author: "Kunyang He"
date: "2025-09-11"
fontsize: 11pt
toc: true
number-sections: true
format:
  html:
    toc: true
    number-sections: true
  pdf:
    documentclass: article
    geometry: margin=1in
    toc: true
    number-sections: true
header-includes: |
  \usepackage{amsmath, amssymb, amsthm}
  \usepackage{hyperref}
  \hypersetup{colorlinks=true, linkcolor=blue, citecolor=blue, urlcolor=blue}
---

# Context and Goals

This note distills the main ideas in *Volz, Kosakovsky Pond, Ward, Leigh Brown, & Frost (2009), Genetics 183(4):1421--1430* and provides detailed answers to the questions raised in the slide deck *STATS 700--002 Class 3: The Volz Coalescent* (Ionides & King, 2025). The focus is on the formal link Volz et al.\ derive between *forward-time* epidemiological dynamics (e.g., SIR) and the *backward-time* coalescent, enabling direct inference of epidemic quantities (e.g., \(R_0\), prevalence trajectories) from viral phylogenies.

# Core notation and epidemic dynamics

Let \(S(t)\), \(I(t)\), and \(R(t)\) be the *fractions* of the total host population that are susceptible, infected, and recovered (so \(S+I+R=1\)). In the mass-action SIR model,
\begin{align}
\dot S(t) &= -\beta S(t) I(t),\\
\dot I(t) &= \beta S(t) I(t) - \gamma I(t),\\
\dot R(t) &= \gamma I(t).
\end{align}
Write \(f_{SI}(t) = \beta S(t) I(t)\) for the *incidence rate* (new infections per unit time, normalized by population size).

# Ancestor function and coalescent rate

Fix a sampling time \(T\). Define the **ancestor function** \(A(t;T)\) to be the fraction of the total host population at time \(t\le T\) that has sampled descendants extant at time \(T\). If a fraction \(\phi\) of infecteds is sampled at \(T\), then \(A(T;T) = \phi I(T)\) and \(0 \le A(t;T) \le I(t)\).

In the Volz formalism, a forward-time transmission event corresponds to a backward-time coalescent event with probability
$$
p_c(t;T) \;=\; \Big(\frac{A(t;T)}{I(t)}\Big)^2.
$$
Hence the *coalescent rate for the sample* equals the product of the incidence and the observation probability. Using backward-time notation,
$$
-\dot A(t;T) \;=\; -\frac{dA}{dt}
\;=\; f_{SI}(t)\,\Big(\frac{A(t;T)}{I(t)}\Big)^2. \tag{2}
$$
Equation (2) maps any forward-time epidemic model that supplies \(f_{SI}(t)\) and \(I(t)\) into a backward-time coalescent rate.

**Qualitative implication.** When \(I(t)\) is large (near peak prevalence), the factor \((A/I)^2\) suppresses the coalescent rate; when incidence is high relative to prevalence (e.g., early growth), the rate increases.

# Cluster size distribution (CSD)

Let \(X_1(t;T)\) be the cluster size at time \(T\) generated by a uniformly chosen infected at time \(t\), conditional on having sampled descendants at \(T\). Let \(x_1(t;T)=\mathbb{E}[X_1(t;T)]\). Let \(X_2(t;T)\) choose clusters *with probability proportional to their size*, and \(x_2(t;T)=\mathbb{E}[X_2(t;T)]\). Volz et al.\ obtain backward ODEs
\begin{align}
-\dot x_1(t;T) &= \frac{f_{SI}(t)\,I(T)}{I(t)^2}, \tag{3}\\
-\dot x_2(t;T) &= 2\,(-\dot x_1(t;T)), \qquad x_1(T;T)=x_2(T;T)=1. \tag{4}
\end{align}
The variance of \(X_1\) is
$$
\mathrm{Var}(X_1) \;=\; x_1\,x_2 - x_1^2. \tag{9}
$$
Higher moments \(M_n(t;T)=\mathbb{E}[X_1^n]\) satisfy the recursion
$$
-\dot M_n \;=\; f_{SI}\,\frac{A}{I^2}\,\sum_{i=0}^{n-1}\binom{n}{i} M_i M_{n-i},
\qquad M_n(T;T)=1, \; M_0\equiv 1. \tag{10}
$$
These equations provide a *null model* for clustering under simple epidemic dynamics and match agent-based simulations reported by Volz et al.\ (their Fig.~2).

# Likelihood from coalescent times

Given a phylogeny on \(n\) sequences sampled (approximately) at time \(T\), let \(t_1,\dots,t_{n-1}\) be the \(n-1\) coalescent times (backwards from \(T\)). The cumulative fraction of coalescent events that occur before \(\tau\) is
$$
F(\tau) \;=\; \frac{A(T;T)-A(\tau;T)}{A(T;T)-A(t;T)}, \qquad t<\tau<T. \tag{11}
$$
with density proportional to \(-\dot A(\tau;T)\). Under the approximation that coalescent events leave the rate for the remaining lineages unchanged, the log-likelihood is
\begin{align}
\Lambda(t_1,\dots,t_{n-1}\mid \theta)
&= \sum_{i=1}^{n-1} \log\!\left(\frac{-\dot A(t_i;T)}{A(T;T)-A(t;T)}\right) \tag{12}\\
&= -(n-1)\log\!\big(A(T;T)-A(t;T)\big) + \sum_{i=1}^{n-1}\log\!\big(-\dot A(t_i;T)\big), \tag{13}
\end{align}
where \(\theta\) are epidemic parameters. This directly links forward-time models to phylogenetic branch times.

# Effect of sampling fraction

If the sample fraction \(\phi\) at \(T\) is large, then \(A(T;T)=\phi I(T)\) is large and \((A/I)^2\) is large near \(T\), so most coalescent events concentrate close to the tips (right-skewed coalescent-time distribution). For small \(\phi\), the distribution is left-skewed (“starlike” trees). Volz et al.\ demonstrate these patterns via simulation (their Fig.~4).

# HIV-1 case study

To capture elevated infectiousness during acute HIV infection and demographic turnover, Volz et al.\ propose a two-stage model,
\begin{align}
\dot S &= -S^\alpha(\beta_1 I_1 + \beta_2 I_2) + \mu - \mu S, \tag{14}\\
\dot I_1 &= S^\alpha(\beta_1 I_1 + \beta_2 I_2) - \gamma_1 I_1 - \mu I_1, \tag{15}\\
\dot I_2 &= \gamma_1 I_1 - \gamma_2 I_2. \tag{16}
\end{align}
They track separate ancestor functions \(A_1,A_2\) for acute/chronic classes, giving
\begin{align}
-\dot A_2 &= -\gamma_1 I_1\,(A_2/I_2) + \beta_2 I_2 S^\alpha\,(A_1/I_1)\big((I_2 - A_2)/I_2\big), \tag{17}\\
-\dot A_1 &= \gamma_1 I_1\,(A_2/I_2) - \beta_1 I_1 S^\alpha\,(A_1/I_1)^2 - \beta_2 I_2 S^\alpha\,(A_1/I_1). \tag{18}
\end{align}
Fitting to an HIV-1 MSM dataset (ACTG241) and aligning the time scale to surveillance back-calculation, they report median estimates implying \(R_0 \approx 2.24\) and roughly \(41\%\) of transmissions during the acute phase, with improved agreement to external incidence data compared to a rescaled skyline plot.

# Limitations and extensions

Key caveats include: selective neutrality (no immune selection), no super-infection/recombination, homogeneous mixing, and sensitivity in recovering decline phases (recovery rates are weakly identified). The framework can be extended to heterochronous sampling and more structured epidemic models.

# Q&A: Answers to STATS 700--002 slides

### Q1. Why are Volz et al.\ interested in the cluster size distribution (CSD)?

Because clusters on phylogenies are often interpreted as epidemiological links (e.g., short transmission chains or risk-group connectivity). The CSD moments provide a principled *null* under SI/SIS/SIR dynamics to benchmark empirical clustering and to test for additional mechanisms (selection, structure).

### Q2. In \(A(t;T)\), does “population” mean total hosts \(N\) or the infected subpopulation \(\mathcal{I}\)? What does the large-population assumption buy us?

\(S\), \(I\), \(R\), and \(A\) are *fractions of the total host population*. \(A(t;T)\) is meaningful only over infecteds, so \(0\le A\le I\). Large-population assumptions justify (i) deterministic ODEs for \(SIR\), (ii) treating \(A\) as continuous and deriving the backward ODE (2), and (iii) the Kingman-like binary coalescent approximation and the i.i.d.\ coalescent-time likelihood.

### Q3. Why are coalescent rates low near peak prevalence but high when incidence/prevalence is large?

Equation (2) shows the rate scales like \(f_{SI}(t)\,(A/I)^2\). Near peak \(I\), \((A/I)^2\) suppresses the rate; early in growth or after troughs, \(I\) is small while \(f_{SI}\) can be comparatively large, increasing the rate. Equations (3)--(4) lead to the same intuition via cluster-moment growth.

### Q4. Is (2) a definition or a derivation?

It is *derived* from forward-time transmissions occurring at rate \(f_{SI}\), each registering in the sample as a coalescent with probability \(p_c=(A/I)^2\). Multiplying yields the observed coalescent rate and, in backward time, (2).

### Q5. How is (12) a likelihood if \(A(t;T)\) is a model quantity, not data?

The data are the coalescent times \(\{t_i\}\). For parameters \(\theta\), \(A(\cdot;\cdot \mid \theta)\) determines the coalescent-time distribution via (11); evaluating the density at the observed \(\{t_i\}\) and multiplying (with the i.i.d.\ approximation) gives a valid likelihood.

### Q6. What are sufficient statistics for the frequency of transmissions over time?

Within this likelihood, the *set of coalescent times* (equivalently, inter-coalescent intervals) is sufficient for the time-varying coalescent rate implied by \(f_{SI}\); tree topology beyond the times does not enter explicitly.

### Q7. Why can an SIR-ODE approach outperform the generalized skyline even with early stochasticity?

Because as \(I\) grows, dynamics quickly concentrate near the deterministic SIR trajectory; early stochasticity mostly shifts coalescent times without changing their shape, which a small set of parameters (e.g., initial infected fraction) can absorb. Mechanistic constraints reduce variance, whereas the skyline is flexible but can over-smooth declines and overestimate later prevalence.

# References

- Volz, E. M., Kosakovsky Pond, S. L., Ward, M. J., Leigh Brown, A. J., & Frost, S. D. W. (2009). *Phylodynamics of infectious disease epidemics*. *Genetics*, 183(4), 1421--1430. <https://doi.org/10.1534/genetics.109.106021>  
- Ionides, E., & King, A. (2025). *STATS 700--002 Class 3: The Volz Coalescent* (slides).
